@model Occupancy.Models.Contratos
 
 
@{
    ViewBag.Title = "EditMovs";
}

<head>   

</head>
<body>
    <br />
    <br />
    <div class="container-fluid">
        <!-- Row 1  con dos panels Info del contrato, persona, espacio, nave, sección, local, cómo se cobra -->
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <!-- Col con panel Info General-->
                    <div class="col-md-6">
                        <div class="panel panel-info">
                            <div class="panel-heading">
                                <h3 class="panel-title"><span class="glyphicon glyphicon-edit" aria-hidden="true" style="font-size: 25px"></span> <strong>  Estado de Cuenta - Edición</strong></h3>
                            </div>
                            <div class="panel-body">
                                Revise o actualice los movimientos relacionados con el estados de cuenta.. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras at aliquam nisi. Cras id nibh ut urna vehicula molestie quis eget justo. Aenean pharetra ut dolor at hendrerit. Integer euismod dolor mi, vitae semper magna vestibulum porttitor.
                            </div>
                        </div>
                    </div>
                    <!-- Col con panel Datos Persona-->
                    <div class="col-md-6">
                        <div class="panel panel-success">
                            <div class="panel-heading">
                                <span class="glyphicon glyphicon-user"></span>
                                <h4><strong>Nombre: @ViewBag.personaNombre</strong></h4>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-sm-12">Nombre Comercial: @ViewBag.nombreComercial</div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">Folio Contrato / Concesión : <strong>@ViewBag.IDContrato</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12"><h3>Saldo: $ @ViewBag.Saldo</h3></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Row 2 -->
        <!-- Row con dos panels Datos Espacio y Datos del Local-->
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <!-- Col con panel Info Espacio-Nave-Sección -->
                    <div class="col-md-6">
                        <div class="panel panel-success">
                            <div class="panel-heading">
                                <span class="glyphicon glyphicon-home"></span>
                                <h4><strong>Espacio: @ViewBag.EspacioNombre</strong></h4>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-sm-4">Nave :</div>
                                    <div class="col-sm-8"><strong>@ViewBag.naveNombre</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">Sección :</div>
                                    <div class="col-sm-8"><strong>@ViewBag.seccionNombre</strong></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Col con panel Info Local, y datos para cobro  -->
                    <div class="col-md-6">
                        <div class="panel panel-success">
                            <div class="panel-heading">
                                <span class="glyphicon glyphicon-home"></span>
                                <h3><strong>Local: @ViewBag.localNombre</strong></h3>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-6">Metros Cuadrados:</div>
                                    <div class="col-md-6"><strong>@ViewBag.localMcuadrados m2</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">Num. Locales para cobro:</div>
                                    <div class="col-md-6"><strong>@ViewBag.localNumParaCobro</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">Tipo Cuota:</div>
                                    <div class="col-md-6"><strong>@ViewBag.localTipoCuota</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">Cuota Renta: $</div>
                                    <div class="col-md-8"><strong>@ViewBag.localCuotaRenta</strong></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4">Importe Renta Mensual: $</div>
                                    <div class="col-md-8"><strong>@ViewBag.localImporteRenta</strong></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Row 3 Datatable Movimientos asociados al Contrato el iCollection miembro del objeto contrato -->
        <div class="row">
            <br />
            <br />
            <table id="miTabla" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().FechaEmision)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().FechaVencimiento)
                        </th>
                        <!-- -->
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().ImporteTotal)
                        </th>
                        <!-- -->
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().TipoMovimiento.NombreCorto)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().TipoMovimiento.Naturaleza)
                        </th>
                        <!-- -->
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().IDOrden)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().Pagado)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().FolioRecibo)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().FechaPago)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.Movimientos.ToList().First().Observaciones)
                        </th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Movimientos)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.FechaEmision)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.FechaVencimiento)
                            </td>
                            <!-- -->
                            <td>
                                @Html.DisplayFor(modelItem => item.ImporteTotal)
                            </td>
                            <!-- -->
                            <td>
                                @Html.DisplayFor(modelItem => item.TipoMovimiento.NombreCorto)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TipoMovimiento.Naturaleza)
                            </td>
                            <!-- -->
                            <td>
                                @Html.DisplayFor(modelItem => item.IDOrden)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Pagado)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.FolioRecibo)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.FechaPago)
                            </td>
                            <!-- -->

                            <td>
                                @Html.DisplayFor(modelItem => item.Observaciones)
                            </td>

                            <td>
                                <!--  si es un cargo y no pagado, se pueede emitir Orden de Pago  -->
                                @Html.ActionLink("Edit", "Edit", new { id = item.IDMovimiento }) |
                                @Html.ActionLink("Details", "Details", new { id = item.IDMovimiento }) |

                                @* @Html.ActionLink("Delete", "Delete", new { id = item.IDMovimiento })*@
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <!-- Definición del Modal AddSaldo . lo coloco en el row, si no solo en el espacio de este container--- lo saco del row -->
        <div class="row">
            <div class="col-md-4">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addMovModal">Cargar Saldo</button>
            </div>
            <div class="col-md-4">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addMonthModal">Cargar Mes</button>
            </div>
            <div class="col-md-4">

            </div>
        </div>

        <br />
        <br />
        <!-- <form method="post" action="AddBalance" controller="Contratos">-->
        @using (Html.BeginForm("AddBalance", "Contratos", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            <!-- Modal --- fade-->
            <!-- Podría incluir un cálculo de número de meses vencidos, sea Corriente o Rezago-->
            <div class="modal fade" id="addMovModal" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="padding:35px 50px;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4><span class="glyphicon glyphicon-plus"></span> Cargar Saldo</h4>
                        </div>
                        <div class="modal-body" style="padding:40px 50px;">
                            <!-- form. method = post-->
                            @*<form role="form" action="AddBalance" method="post" id="formAddB">*@
                            <div class="row">
                                <div class="col-md-6">
                                    <h4><strong>Nombre: @ViewBag.personaNombre</strong></h4>
                                </div>
                                <div class="col-md-6">
                                    <h4><strong>Espacio: @ViewBag.EspacioNombre</strong></h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    Nave: @ViewBag.naveNombre
                                </div>
                                <div class="col-md-6">
                                    Local: @ViewBag.localNombre
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    Num. Locales para cobro: @ViewBag.localNumParaCobro
                                </div>
                                <div class="col-md-6">
                                    Tipo Cuota: @ViewBag.localTipoCuota
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    Importe Renta Mensual: $ @ViewBag.localImporteRenta
                                </div>
                            </div>
                            <br />
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="importe"> Importe</label>
                                        <input type="number" class="form-control" style="width:auto" id="importe" name="importe" min="1">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="obs"> Observaciones</label>
                                        @* <input type="text" class="form-control" new { style="max-width:100%" , rows=7 } id="obs" name="obs">*@
                                        <textarea class="form-control" rows="5" style="width:auto" id="obs" name="obs"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="tipoM"> Tipo de Saldo Inicial</label>
                                <div class="col-md-10">
                                    <div class="editor-field">
                                        <select class="form-control" id="tipoSaldo" name="tipoSaldo" style="width:auto">
                                            <option>SALDO INICIAL REZAGO</option>
                                            <option>SALDO INICIAL CORRIENTE</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <br />
                            <br />
                            <!-- </form> form="formAddB" -->
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-success"> <span class="glyphicon glyphicon-save"></span> Grabar</button>
                            <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                        </div>
                    </div>

                </div>
            </div>
            @* modal termina *@
        }
        <!-- </form>  -->
        <!-- Definición del Modal AddSaldo . lo coloco en el row, si no solo en el espacio de este container--- lo saco del row -->
        @*<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addMonthModal">Cargar Mes</button>
        <br />
        <br />*@
        <!-- <form method="post" action="AddBalance" controller="Contratos">-->
        @using (Html.BeginForm("AddMonth", "Contratos", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            <!-- Modal --- fade-->
            <!-- Podría incluir un cálculo de número de meses vencidos, sea Corriente o Rezago-->
            <div class="modal fade" id="addMonthModal" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="padding:35px 50px;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4><span class="glyphicon glyphicon-plus"></span> Cargar Mes</h4>
                        </div>
                        <div class="modal-body" style="padding:40px 50px;">
                            <div class="row">
                                <div class="col-md-6">
                                    <h4><strong>Nombre: @ViewBag.personaNombre</strong></h4>
                                </div>
                                <div class="col-md-6">
                                    <h4><strong>Espacio: @ViewBag.EspacioNombre</strong></h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    Nave: @ViewBag.naveNombre
                                </div>
                                <div class="col-md-6">
                                    Local: @ViewBag.localNombre
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    Num. Locales para cobro: @ViewBag.localNumParaCobro
                                </div>
                                <div class="col-md-6">
                                    Tipo Cuota: @ViewBag.localTipoCuota
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    Importe Renta Mensual: $ @ViewBag.localImporteRenta
                                </div>
                            </div>
                            <br />

                            <div class="checkbox">
                                <label>
                                    <input type="checkbox"> Enero
                                </label>
                            </div>

                            @*<div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <label for="importe"> Importe</label>
                    <input type="number" class="form-control" style="width:auto" id="importe" name="importe" min="1">
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="obs"> Observaciones</label>
                    <textarea class="form-control" rows="5" style="width:auto" id="obs" name="obs"></textarea>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="tipoM"> Tipo de Saldo Inicial</label>
            <div class="col-md-10">
                <div class="editor-field">
                    <select class="form-control" id="tipoSaldo" name="tipoSaldo" style="width:auto">
                        <option>SALDO INICIAL REZAGO</option>
                        <option>SALDO INICIAL CORRIENTE</option>
                    </select>
                </div>
            </div>*@
                            @*</div>*@
                            <br />
                            <br />
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-success"> <span class="glyphicon glyphicon-save"></span> Grabar</button>
                            <button type="button" class="btn btn-danger" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>

    @section scripts {
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap.min.css">

        <script type="text/javascript" charset="utf8" src=" https://code.jquery.com/jquery-3.5.1.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap.min.js"></script>
        <script>
            $(document).ready(function () {
                $("#addBalanceBtn").click(function () {
                    $("#myModal").modal('show');
                });
            });

        </script>
        <script>
            $(document).ready(function () {
                $('#miTabla').DataTable({
                    "responsive": {
                        "details": {
                            "type": "column"
                        }
                    },
                    "columnDefs": [{
                        "className": "dtr-control",
                        "orderable": false,
                        "targets": 0
                    }],
                    "language": {
                        "emptyTable": "Aún no hay datos en la tabla",
                        "lengthMenu": "Mostrar _MENU_ filas",
                        "search": "Buscar:",
                        "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
                        "infoEmpty": "Mostrando 0 a 0 de 0 registros",
                        "infoFiltered": "(De un total de regsitros _MAX_ .)",
                        "paginate": {
                            "first": "Primer",
                            "last": "Ultimo",
                            "next": "Siguiente",
                            "previous": "Anterior"
                        },
                        "pageLength": 10
                    }
                });
            });
        </script>
    }
</body>
